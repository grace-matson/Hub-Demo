name: hello

on:
  # push:
  #   branches: [ main ]
  # pull_request:
  #   branches: [ main ]

  workflow_dispatch:

jobs:
  job:
    runs-on: ubuntu-latest
    steps:
    - name: Revert changes checkout
      uses: actions/checkout@v2
      with:
        fetch-depth: 0
    # - name: Declare some variables
    #   id: vars
    #   shell: bash
    #   run: |
    #     echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
    #     echo "::set-output name=sha_short::$(git rev-parse --short HEAD~1)"

    # - name: Another step
    #   run: |
    #     echo "Branch: ${{ steps.vars.outputs.branch }}"
    #     echo "Sha: ${{ steps.vars.outputs.sha_short }}"
    # - name: Revert changes
    #   run: |
    #     git config user.name grace-matson
    #     git config user.email gracematson@google.com
    #     git reset ${{ steps.vars.outputs.sha_short }}
    #     git add .
    #     git commit -m "Trying to revert to ${{ steps.vars.outputs.sha_short }}"

    # - name: Create Pull Request
    #   uses: peter-evans/create-pull-request@v3.10.0
    #   with:
    #     token: ${{ github.token }}
    #     title: 'Automated PR'
    #     body: |
    #       This PR is auto-generated 
    #     branch: revert

    # - uses: bahmutov/npm-install@v1.4.5
    # - uses: nrwl/last-successful-commit-action@v1
    - uses: SamhammerAG/last-successful-build-action@v2
      id: last_successful_commit
      with:
        token: ${{ github.token }}
        branch: "main"
        workflow: "hello"
        verify: true

    - name: Commit hash
      run: |
        echo "Branch: ${{ steps.last_successful_commit.outputs.sha }}"

  # first_job:
  #   runs-on: ubuntu-latest
  #   steps:
  #   - uses: actions/github-script@v3
  #     with:
  #       script: |
  #           core.setFailed('failing on purpose')

  # second_job:
  #   runs-on: ubuntu-latest
  #   needs: first_job
  #   if: ${{ failure()}}
  #   steps:
  #     - run: echo "Hello world"

      # Runs a single command using the runners shell
#       - name: Hello world 
#         run: echo Hello, world!
#       - name: Gcloud command check
#         run: gcloud auth list
#       - name: Check Project
#         run: gcloud config list project
      # - run: |
      #     chmod +x ./.github/scripts/hello.sh
      #     ./.github/scripts/hello.sh
#
