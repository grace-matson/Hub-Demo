{
  "batchInterval": "1s",
  "resources": {
    "memoryMB": 512,
    "virtualCores": 1
  },
  "driverResources": {
    "memoryMB": 512,
    "virtualCores": 1
  },
  "connections": [
    {
      "from": "Kafka",
      "to": "LogParser"
    },
    {
      "from": "LogParser",
      "to": "ID Generator"
    },
    {
      "from": "ID Generator",
      "to": "GCS"
    }
  ],
  "comments": [],
  "postActions": [],
  "stages": [
    {
      "name": "Kafka",
      "plugin": {
        "name": "Kafka",
        "type": "streamingsource",
        "label": "Kafka",
        "artifact": {
          "name": "kafka-plugins",
          "version": "[1.7.0-0.8.2.2, 3.0.0-SNAPSHOT)",
          "scope": "USER"
        },
        "properties": {
          "schema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"message\",\"type\":\"string\"}]}",
          "format": "text",
          "referenceName": "kafkaAccessLogs"
        }
      },
      "outputSchema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"message\",\"type\":\"string\"}]}",
      "type": "streamingsource",
      "label": "Kafka",
      "icon": "icon-kafka",
      "_uiPosition": {
        "top": "297px",
        "left": "198.5px"
      },
      "$$hashKey": "object:5248"
    },
    {
      "name": "LogParser",
      "plugin": {
        "name": "LogParser",
        "type": "transform",
        "label": "LogParser",
        "artifact": {
          "name": "core-plugins",
          "version": "[1.7.0-SNAPSHOT, 3.0.0-SNAPSHOT)",
          "scope": "SYSTEM"
        },
        "properties": {
          "logFormat": "CLF",
          "inputName": "message"
        }
      },
      "outputSchema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"uri\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"browser\",\"type\":\"string\"},{\"name\":\"device\",\"type\":\"string\"},{\"name\":\"httpStatus\",\"type\":\"int\"},{\"name\":\"ts\",\"type\":\"long\"}]}",
      "inputSchema": [
        {
          "name": "Kafka",
          "schema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"message\",\"type\":\"string\"}]}"
        }
      ],
      "type": "transform",
      "label": "LogParser",
      "icon": "icon-logparser",
      "_uiPosition": {
        "top": "297px",
        "left": "498.5px"
      },
      "$$hashKey": "object:5249"
    },
    {
      "name": "ID Generator",
      "plugin": {
        "name": "JavaScript",
        "type": "transform",
        "label": "ID Generator",
        "artifact": {
          "name": "core-plugins",
          "version": "[1.7.0-SNAPSHOT, 3.0.0-SNAPSHOT)",
          "scope": "SYSTEM"
        },
        "properties": {
          "script": "function transform(input, emitter, context) {\n  var id = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\n    return v.toString(16);\n  });\n  input['id'] = id;\n  emitter.emit(input);\n}",
          "schema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"uri\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"browser\",\"type\":\"string\"},{\"name\":\"device\",\"type\":\"string\"},{\"name\":\"httpStatus\",\"type\":\"int\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"id\",\"type\":\"string\"}]}"
        }
      },
      "outputSchema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"uri\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"browser\",\"type\":\"string\"},{\"name\":\"device\",\"type\":\"string\"},{\"name\":\"httpStatus\",\"type\":\"int\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"id\",\"type\":\"string\"}]}",
      "inputSchema": [
        {
          "name": "LogParser",
          "schema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"uri\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"browser\",\"type\":\"string\"},{\"name\":\"device\",\"type\":\"string\"},{\"name\":\"httpStatus\",\"type\":\"int\"},{\"name\":\"ts\",\"type\":\"long\"}]}"
        }
      ],
      "type": "transform",
      "label": "ID Generator",
      "icon": "icon-javascript",
      "_uiPosition": {
        "top": "297px",
        "left": "798.5px"
      },
      "$$hashKey": "object:5250"
    },
    {
        "name": "GCS",
        "plugin": {
            "name": "GCS",
            "type": "batchsink",
            "label": "Google Cloud Storage",
            "artifact": {
                "name": "google-cloud",
                "version": "[0.12.0,1.0.0-SNAPSHOT)",
                "scope": "SYSTEM"
            },
            "properties": {
          "schema": "{\"type\":\"record\",\"name\":\"etlSchemaBody\",\"fields\":[{\"name\":\"uri\",\"type\":\"string\"},{\"name\":\"ip\",\"type\":\"string\"},{\"name\":\"browser\",\"type\":\"string\"},{\"name\":\"device\",\"type\":\"string\"},{\"name\":\"httpStatus\",\"type\":\"int\"},{\"name\":\"ts\",\"type\":\"long\"},{\"name\":\"id\",\"type\":\"string\"}]}"
            }
        }
    }
  ]
}
